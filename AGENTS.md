---
project: NexusHub v6
agent_framework: Claude Code
version: 1.0
created: 2025-10-23
rules:
  - no_mock: true
  - no_test_only: true
  - must_production_ready: true
  - gas_supported_extensions:
      - ".html"
      - ".gs"
description: |
  このファイルは、Claude Code（AIコーディングエージェント）を用いて
  プロジェクト「NexusHub v6」を **本番環境レベルで実装・保守**するための
  ガイドライン、ルール、ワークフローを一元管理するものです。
  チームおよび Claude Code セッションが本指針を共有し、品質・一貫性・安全を確保します。
---

# AGENTS Manifest for NexusHub v6

## 1. 前提条件・プロジェクトコンテキスト  
- 使用技術スタック：HTML／CSS／JavaScript（Vanilla JS）＋ Google Apps Script（GAS）  
- デザインシステム：Material Design 3（カラー・タイポグラフィ・形状・モーションがトークン化済）  
- 対応プラットフォーム：モバイル／タブレット／デスクトップ（レスポンシブ）  
- アクセシビリティ基準：WCAG 2.1 AA 準拠（キーボード操作／スクリーンリーダー対応／フォーカス可視化必須）  
- パフォーマンス目標：UI操作遅延50 ms以内、重大なレイアウトシフトなし、低スペック環境でもスムーズ動作  
- リポジトリ構成：既存コードベースが稼働中。Claude Code はこの構成を理解済とみなす  
- **GAS において使用可能なファイル拡張子は「.html」と「.gs」のみ**とする  

## 2. Claude Code 利用ルール／ベストプラクティス  
### 2.1 プロンプト設計  
- 明確かつ**具体的**な指示を提供。曖昧な「〜して」ではなく「〜を次の手順で実行し、モックを使わず本番動作を保証し、同期APIを実装」など。 :contentReference[oaicite:1]{index=1}  
- “背景／目的”を併記し、なぜこの変更が必要かを説明。 :contentReference[oaicite:2]{index=2}  
- テスト観点／パフォーマンス要件／制約条件（例：モック禁止／GAS拡張子制限）を明示。  
- プラン → 承認 → 実装という段階的ワークフローを維持。  

### 2.2 モデル／CLIの操作  
- `claude -p "<指示>"` などCLIから実行可能。 :contentReference[oaicite:3]{index=3}  
- `.claude/settings.json` にてプロジェクトレベル設定を管理。 :contentReference[oaicite:4]{index=4}  
- 「think」「think harder」など思考バジェット制御キーワードを活用。 :contentReference[oaicite:5]{index=5}  

### 2.3 自動化・安全性  
- Claude Code が変更を加える前に、**人によるレビュー／承認**を必須とする。 :contentReference[oaicite:6]{index=6}  
- モック／テスト専用コードの生成は禁止。**必ず本番環境動作を目的としたコード**とし、モックではなく実ロジックを実装。  
- プロジェクト設定で許可拡張子を制限（.html／.gs のみ読み書き対象）とし、不要なファイル生成や拡張子の乱用を防止。  
- ファイル削除や重大変更操作には手動承認フローを設定。  

## 3. ワークフロー／タスク管理  
### 3.1 フィーチャー追加・実装  
1. 指示出す前に、仕様書・要件・非機能要件（アクセシビリティ・パフォーマンス・セキュリティ）を整理。  
2. Claude にまず「実装プラン（ステップ、影響範囲、非機能対応）」を作成させ、レビュー＆承認後に実装開始。  
3. **モック作成・テスト作成を目的としたタスクは禁止**。実装は本番運用可能なコードであること。  
4. コミットメッセージ・PR説明をClaudeに自動生成させ、レビュー担当者が最終確認。  
5. 必要に応じて `.html`／`.gs` ファイルを生成・修正。その他の拡張子は禁止。  

### 3.2 バグ修正・リファクタリング  
- ログやエラーメッセージを提示→Claude に原因分析を依頼→修正案提示→コード修正。  
- テストコードを生成する場合も**本番コードの仕様検証目的**とし、モック専用ライブラリ使用禁止。  
- 二次的ファイル（.html/.gs以外）への変更は禁止。  

### 3.3 ドキュメンテーション・設計更新  
- 新たなコンポーネントやモジュール追加時にはREADME・設計書を更新。  
- ドキュメントとして Markdown のみならず YAML 前書きも可能とする。  

## 4. 典型的プロンプトテンプレート  
あなたはプロフェッショナルなフルスタック／UI／UXエンジニアです。

プロジェクト「NexusHub v6」において、以下の仕様を**モックやテスト専用実装をせず、完全に本番環境動作を目的として**実装してください。

【対象機能】：（例：リンクフォルダ内ドラッグ＆ドロップ並び替え）

【仕様・必須振る舞い】：

- …（具体的仕様）
- …
- 非機能要件：アクセシビリティ／パフォーマンス／レスポンシブ／.html/.gsのみ使用
    
    【出力形式】：
    
- 対象ファイル名：…
- 変更内容：箇条書き
- 各ファイルの主要コードスニペット（.gs＋.html＋CSS／JS）
- テスト観点（ただしテストは「モックではなく本番仕様検証用」）
- コミットメッセージ案：例 “feat(link-folder): add drag/drop sort #123”


## 5. プロジェクト固有ルール（NexusHub用）  
- コードスタイル：ESLint／Prettierなど既導入。  
- ブランチ命名： `feature/xxxx`, `bugfix/xxxx`, `refactor/xxxx`。  
- アクセシビリティ：全インタラクティブ要素に `aria-*` 属性、キーボード操作可必須。  
- パフォーマンス基準：Lighthouse モバイルスコア70以上、Core Web Vitals (LCP < 2.5s, FID < 100ms, CLS < 0.1) を目指す。  
- ドキュメント更新：実装完了時には `docs/CHANGELOG.md` に概要記録、`README.md` に更新。  
- **GAS拡張子制限**：GAS用ファイルには必ず「.gs」、UI用HTMLには「.html」のみ使用。その他の拡張子生成禁止。  
- **モック・テスト用コード排除**：モックやスタブ、テスト専用実装としてのコードを inc → 「実運用ロジックとして機能する」コードを必ず書く。  

## 6. チェックリスト  
- [ ] プランをClaudeに作成させ、レビュー済みか  
- [ ] 指示に「モック禁止」「本番環境動作」「.html/.gs限定」が明記されているか  
- [ ] コード変更前に非機能要件・拡張子制限が遵守されているか  
- [ ] コードレビュー・アクセシビリティチェック・パフォーマンス計測済みか  
- [ ] ドキュメント／コミットメッセージが適切か  
- [ ] 実装が本番運用レベルを満たしているか  

## 7. よくある落とし穴と回避策  
- 曖昧な指示 → モック仕様や例示のみの実装になりがち。必ず「本番環境動作」を明言してください。  
- 拡張子混在：GASの制約を忘れて `.js`, `.ts`, `.jsx`, `.py` などを生成しないように。  
- テストばかり重視：テスト作成だけでロジックが動かないままになること。モックテストではなく “実装＆検証” フローを守る。  
- 自動化に任せ切るとレビュー漏れ・設計欠陥の温床に。必ず人が最終確認。  
- Claude の権限を過信すると想定外のファイル削除・コミットが起こるため “auto commit” には慎重に。  

## 8. 更新履歴  
- 2025-10-23 初版（モック／テスト禁止・.html/.gs制限追加）  

